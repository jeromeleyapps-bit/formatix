[2026-02-03 00:11:52.906 +01:00 INF] HTTP GET / responded 200 in 364.4925 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ2L2OJ11DN:00000001","ConnectionId":"0HNJ2L2OJ11DN","EnvironmentName":"Production","MachineName":"PC_JEY","ThreadId":25}
[2026-02-03 00:11:52.939 +01:00 INF] HTTP GET /css/opagax-custom.css responded 304 in 2.7732 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ2L2OJ11DN:00000002","ConnectionId":"0HNJ2L2OJ11DN","EnvironmentName":"Production","MachineName":"PC_JEY","ThreadId":25}
[2026-02-03 00:11:52.951 +01:00 INF] HTTP GET /js/opagax.js responded 304 in 0.5379 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ2L2OJ11DO:00000001","ConnectionId":"0HNJ2L2OJ11DO","EnvironmentName":"Production","MachineName":"PC_JEY","ThreadId":26}
[2026-02-03 00:26:03.993 +01:00 INF] HTTP GET /Settings responded 200 in 122.2873 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ2L2OJ11DP:00000001","ConnectionId":"0HNJ2L2OJ11DP","EnvironmentName":"Production","MachineName":"PC_JEY","ThreadId":28}
[2026-02-03 00:26:04.039 +01:00 INF] HTTP GET /css/opagax-custom.css responded 304 in 0.2550 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ2L2OJ11DP:00000002","ConnectionId":"0HNJ2L2OJ11DP","EnvironmentName":"Production","MachineName":"PC_JEY","ThreadId":28}
[2026-02-03 00:26:04.040 +01:00 INF] HTTP GET /js/opagax.js responded 304 in 0.1783 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ2L2OJ11DQ:00000001","ConnectionId":"0HNJ2L2OJ11DQ","EnvironmentName":"Production","MachineName":"PC_JEY","ThreadId":28}
[2026-02-03 00:26:22.668 +01:00 INF] HTTP POST /Settings/ResetUserPassword responded 302 in 159.1000 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ2L2OJ11DQ:00000002","ConnectionId":"0HNJ2L2OJ11DQ","EnvironmentName":"Production","MachineName":"PC_JEY","ThreadId":32}
[2026-02-03 00:26:22.677 +01:00 INF] HTTP GET /Settings responded 200 in 5.7713 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ2L2OJ11DQ:00000003","ConnectionId":"0HNJ2L2OJ11DQ","EnvironmentName":"Production","MachineName":"PC_JEY","ThreadId":28}
[2026-02-03 00:26:35.787 +01:00 INF] HTTP POST /Settings/DeleteUser responded 302 in 37.4389 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ2L2OJ11DQ:00000004","ConnectionId":"0HNJ2L2OJ11DQ","EnvironmentName":"Production","MachineName":"PC_JEY","ThreadId":32}
[2026-02-03 00:26:35.797 +01:00 INF] HTTP GET /Settings responded 200 in 5.7542 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ2L2OJ11DQ:00000005","ConnectionId":"0HNJ2L2OJ11DQ","EnvironmentName":"Production","MachineName":"PC_JEY","ThreadId":32}
[2026-02-03 00:26:46.814 +01:00 INF] HTTP POST /Settings/UpdateUser responded 302 in 57.2191 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ2L2OJ11DQ:00000006","ConnectionId":"0HNJ2L2OJ11DQ","EnvironmentName":"Production","MachineName":"PC_JEY","ThreadId":32}
[2026-02-03 00:26:46.820 +01:00 INF] HTTP GET /Settings responded 200 in 2.5592 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ2L2OJ11DQ:00000007","ConnectionId":"0HNJ2L2OJ11DQ","EnvironmentName":"Production","MachineName":"PC_JEY","ThreadId":32}
[2026-02-03 00:26:50.297 +01:00 INF] HTTP GET / responded 200 in 11.0197 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ2L2OJ11DQ:00000008","ConnectionId":"0HNJ2L2OJ11DQ","EnvironmentName":"Production","MachineName":"PC_JEY","ThreadId":32}
[2026-02-03 00:26:55.668 +01:00 INF] HTTP GET /Admin/Dashboard responded 200 in 209.6780 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ2L2OJ11DQ:00000009","ConnectionId":"0HNJ2L2OJ11DQ","EnvironmentName":"Production","MachineName":"PC_JEY","ThreadId":32}
[2026-02-03 00:26:56.787 +01:00 INF] HTTP GET /Admin/Diagnostics responded 200 in 33.8928 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ2L2OJ11DQ:0000000A","ConnectionId":"0HNJ2L2OJ11DQ","EnvironmentName":"Production","MachineName":"PC_JEY","ThreadId":28}
[2026-02-03 00:27:08.419 +01:00 INF] HTTP GET /Formations responded 200 in 48.3370 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ2L2OJ11DQ:0000000B","ConnectionId":"0HNJ2L2OJ11DQ","EnvironmentName":"Production","MachineName":"PC_JEY","ThreadId":32}
[2026-02-03 00:27:10.455 +01:00 INF] HTTP GET /Admin/Dashboard responded 200 in 11.9605 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ2L2OJ11DQ:0000000C","ConnectionId":"0HNJ2L2OJ11DQ","EnvironmentName":"Production","MachineName":"PC_JEY","ThreadId":32}
[2026-02-03 00:27:11.575 +01:00 INF] HTTP GET /Admin/Diagnostics responded 200 in 13.4523 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ2L2OJ11DQ:0000000D","ConnectionId":"0HNJ2L2OJ11DQ","EnvironmentName":"Production","MachineName":"PC_JEY","ThreadId":28}
[2026-02-03 00:34:25.305 +01:00 INF] HTTP GET /Admin/Diagnostics responded 200 in 8.9397 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ2L2OJ11DR:00000001","ConnectionId":"0HNJ2L2OJ11DR","EnvironmentName":"Production","MachineName":"PC_JEY","ThreadId":38}
[2026-02-03 00:34:25.389 +01:00 INF] HTTP GET /icon.png responded 200 in 17.5033 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ2L2OJ11DR:00000002","ConnectionId":"0HNJ2L2OJ11DR","EnvironmentName":"Production","MachineName":"PC_JEY","ThreadId":35}
[2026-02-03 00:34:31.730 +01:00 INF] HTTP GET /Admin/Diagnostics responded 200 in 4.0809 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ2L2OJ11DR:00000003","ConnectionId":"0HNJ2L2OJ11DR","EnvironmentName":"Production","MachineName":"PC_JEY","ThreadId":39}
[2026-02-03 00:34:31.752 +01:00 INF] HTTP GET /css/opagax-custom.css responded 200 in 1.4725 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ2L2OJ11DR:00000004","ConnectionId":"0HNJ2L2OJ11DR","EnvironmentName":"Production","MachineName":"PC_JEY","ThreadId":39}
[2026-02-03 00:34:31.753 +01:00 INF] HTTP GET /js/opagax.js responded 200 in 1.1156 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ2L2OJ11DS:00000001","ConnectionId":"0HNJ2L2OJ11DS","EnvironmentName":"Production","MachineName":"PC_JEY","ThreadId":35}
[2026-02-03 00:34:31.863 +01:00 INF] HTTP GET /icon.png responded 200 in 0.9711 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ2L2OJ11DS:00000002","ConnectionId":"0HNJ2L2OJ11DS","EnvironmentName":"Production","MachineName":"PC_JEY","ThreadId":39}
[2026-02-03 00:35:29.702 +01:00 INF] Démarrage de l'application FormatiX {"EnvironmentName":"Production","MachineName":"PC_JEY","ThreadId":2}
[2026-02-03 00:35:31.107 +01:00 INF] Base de données migrée avec succès {"SourceContext":"Program","EnvironmentName":"Production","MachineName":"PC_JEY","ThreadId":2}
[2026-02-03 00:35:31.605 +01:00 INF] Base de données initialisée avec succès {"SourceContext":"Program","EnvironmentName":"Production","MachineName":"PC_JEY","ThreadId":2}
[2026-02-03 00:35:31.612 +01:00 INF] Application FormatiX démarrée avec succès {"EnvironmentName":"Production","MachineName":"PC_JEY","ThreadId":2}
[2026-02-03 00:35:35.753 +01:00 DBG] Ollama n'est pas disponible {"SourceContext":"FormationManager.Infrastructure.AI.OllamaAIService","EnvironmentName":"Production","MachineName":"PC_JEY","ThreadId":8}
System.Net.Http.HttpRequestException: Aucune connexion n’a pu être établie car l’ordinateur cible l’a expressément refusée. (localhost:11434)
 ---> System.Net.Sockets.SocketException (10061): Aucune connexion n’a pu être établie car l’ordinateur cible l’a expressément refusée.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.ConnectToTcpHostAsync(String host, Int32 port, HttpRequestMessage initialRequest, Boolean async, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at System.Net.Http.HttpConnectionPool.ConnectToTcpHostAsync(String host, Int32 port, HttpRequestMessage initialRequest, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.ConnectAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.CreateHttp11ConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.InjectNewHttp11ConnectionAsync(QueueItem queueItem)
   at System.Threading.Tasks.TaskCompletionSourceWithCancellation`1.WaitWithCancellationAsync(CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.SendWithVersionDetectionAndRetryAsync(HttpRequestMessage request, Boolean async, Boolean doRequestAuth, CancellationToken cancellationToken)
   at System.Net.Http.RedirectHandler.SendAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at Microsoft.Extensions.Http.Logging.LoggingHttpMessageHandler.<SendCoreAsync>g__Core|4_0(HttpRequestMessage request, Boolean useAsync, CancellationToken cancellationToken)
   at Microsoft.Extensions.Http.Logging.LoggingScopeHttpMessageHandler.<SendCoreAsync>g__Core|4_0(HttpRequestMessage request, Boolean useAsync, CancellationToken cancellationToken)
   at System.Net.Http.HttpClient.<SendAsync>g__Core|83_0(HttpRequestMessage request, HttpCompletionOption completionOption, CancellationTokenSource cts, Boolean disposeCts, CancellationTokenSource pendingRequestsCts, CancellationToken originalCancellationToken)
   at FormationManager.Infrastructure.AI.OllamaAIService.IsServiceAvailableAsync() in C:\AI\Opagax\Infrastructure\AI\OllamaAIService.cs:line 136
[2026-02-03 00:35:35.789 +01:00 WRN] Ollama n'est pas disponible. Tentative de démarrage automatique: ollama serve {"SourceContext":"FormationManager.Infrastructure.AI.OllamaAutoStartHostedService","EnvironmentName":"Production","MachineName":"PC_JEY","ThreadId":8}
[2026-02-03 00:35:35.805 +01:00 WRN] AutoStart Ollama a échoué: An error occurred trying to start process 'ollama' with working directory 'C:\AI\Opagax'. Le fichier spécifié est introuvable. {"SourceContext":"FormationManager.Infrastructure.AI.OllamaAutoStartHostedService","EnvironmentName":"Production","MachineName":"PC_JEY","ThreadId":8}
System.ComponentModel.Win32Exception (2): An error occurred trying to start process 'ollama' with working directory 'C:\AI\Opagax'. Le fichier spécifié est introuvable.
   at System.Diagnostics.Process.StartWithCreateProcess(ProcessStartInfo startInfo)
   at System.Diagnostics.Process.Start(ProcessStartInfo startInfo)
   at FormationManager.Infrastructure.AI.OllamaAutoStartHostedService.StartAsync(CancellationToken cancellationToken) in C:\AI\Opagax\Infrastructure\AI\OllamaAutoStartHostedService.cs:line 68
[2026-02-03 00:35:35.841 +01:00 INF] Now listening on: http://localhost:5000 {"EventId":{"Id":14,"Name":"ListeningOnAddress"},"SourceContext":"Microsoft.Hosting.Lifetime","EnvironmentName":"Production","MachineName":"PC_JEY","ThreadId":8}
[2026-02-03 00:35:35.851 +01:00 INF] Application started. Press Ctrl+C to shut down. {"SourceContext":"Microsoft.Hosting.Lifetime","EnvironmentName":"Production","MachineName":"PC_JEY","ThreadId":8}
[2026-02-03 00:35:35.856 +01:00 INF] Hosting environment: Production {"SourceContext":"Microsoft.Hosting.Lifetime","EnvironmentName":"Production","MachineName":"PC_JEY","ThreadId":8}
[2026-02-03 00:35:35.862 +01:00 INF] Content root path: C:\AI\Opagax {"SourceContext":"Microsoft.Hosting.Lifetime","EnvironmentName":"Production","MachineName":"PC_JEY","ThreadId":8}
[2026-02-03 00:37:11.064 +01:00 WRN] Failed to determine the https port for redirect. {"EventId":{"Id":3,"Name":"FailedToDeterminePort"},"SourceContext":"Microsoft.AspNetCore.HttpsPolicy.HttpsRedirectionMiddleware","RequestId":"0HNJ2MFUA0N8O:00000001","RequestPath":"/Admin/Diagnostics","ConnectionId":"0HNJ2MFUA0N8O","EnvironmentName":"Production","MachineName":"PC_JEY","ThreadId":14}
[2026-02-03 00:37:11.382 +01:00 INF] HTTP GET /Admin/Diagnostics responded 200 in 318.7378 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ2MFUA0N8O:00000001","ConnectionId":"0HNJ2MFUA0N8O","EnvironmentName":"Production","MachineName":"PC_JEY","ThreadId":14}
[2026-02-03 00:37:14.682 +01:00 INF] HTTP GET /Settings responded 200 in 203.5522 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ2MFUA0N8O:00000002","ConnectionId":"0HNJ2MFUA0N8O","EnvironmentName":"Production","MachineName":"PC_JEY","ThreadId":14}
[2026-02-03 00:50:33.515 +01:00 INF] HTTP GET /Stagiaires responded 200 in 270.5368 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ2MFUA0N8Q:00000001","ConnectionId":"0HNJ2MFUA0N8Q","EnvironmentName":"Production","MachineName":"PC_JEY","ThreadId":18}
[2026-02-03 00:50:33.562 +01:00 INF] HTTP GET /css/opagax-custom.css responded 304 in 6.5867 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ2MFUA0N8R:00000001","ConnectionId":"0HNJ2MFUA0N8R","EnvironmentName":"Production","MachineName":"PC_JEY","ThreadId":21}
[2026-02-03 00:50:33.565 +01:00 INF] HTTP GET /js/opagax.js responded 304 in 0.5355 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ2MFUA0N8S:00000001","ConnectionId":"0HNJ2MFUA0N8S","EnvironmentName":"Production","MachineName":"PC_JEY","ThreadId":22}
[2026-02-03 00:50:56.980 +01:00 INF] HTTP GET /Documents responded 200 in 58.0247 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ2MFUA0N8S:00000002","ConnectionId":"0HNJ2MFUA0N8S","EnvironmentName":"Production","MachineName":"PC_JEY","ThreadId":18}
[2026-02-03 00:51:11.556 +01:00 INF] HTTP GET /QualiopiUi responded 200 in 73.6465 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ2MFUA0N8S:00000003","ConnectionId":"0HNJ2MFUA0N8S","EnvironmentName":"Production","MachineName":"PC_JEY","ThreadId":3}
[2026-02-03 00:51:15.115 +01:00 INF] HTTP GET /QualiopiUi/Preuves responded 200 in 50.9245 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ2MFUA0N8S:00000004","ConnectionId":"0HNJ2MFUA0N8S","EnvironmentName":"Production","MachineName":"PC_JEY","ThreadId":3}
[2026-02-03 00:51:26.167 +01:00 ERR] Failed executing DbCommand (1ms) [Parameters=[@p3='?' (DbType = Int32), @p0='?', @p1='?' (DbType = DateTime), @p2='?' (DbType = Boolean)], CommandType='"Text"', CommandTimeout='30']
UPDATE "PreuvesQualiopi" SET "CommentaireValidation" = @p0, "DateValidation" = @p1, "EstValide" = @p2
WHERE "Id" = @p3
RETURNING 1; {"EventId":{"Id":20102,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandError"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","ActionId":"6094029a-6043-4de5-98e8-e38a5f4e77d6","ActionName":"FormationManager.Controllers.QualiopiUiController.ValiderPreuve (FormationManager)","RequestId":"0HNJ2MFUA0N8S:00000005","RequestPath":"/QualiopiUi/ValiderPreuve","ConnectionId":"0HNJ2MFUA0N8S","EnvironmentName":"Production","MachineName":"PC_JEY","ThreadId":3}
[2026-02-03 00:51:26.191 +01:00 ERR] An exception occurred in the database while saving changes for context type 'FormationManager.Data.FormationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.Sqlite.SqliteException (0x80004005): SQLite Error 19: 'NOT NULL constraint failed: PreuvesQualiopi.CommentaireValidation'.
   at Microsoft.Data.Sqlite.SqliteException.ThrowExceptionForRC(Int32 rc, sqlite3 db)
   at Microsoft.Data.Sqlite.SqliteDataReader.NextResult()
   at Microsoft.Data.Sqlite.SqliteCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.Data.Sqlite.SqliteCommand.ExecuteReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.Data.Sqlite.SqliteCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken) {"EventId":{"Id":10000,"Name":"Microsoft.EntityFrameworkCore.Update.SaveChangesFailed"},"SourceContext":"Microsoft.EntityFrameworkCore.Update","ActionId":"6094029a-6043-4de5-98e8-e38a5f4e77d6","ActionName":"FormationManager.Controllers.QualiopiUiController.ValiderPreuve (FormationManager)","RequestId":"0HNJ2MFUA0N8S:00000005","RequestPath":"/QualiopiUi/ValiderPreuve","ConnectionId":"0HNJ2MFUA0N8S","EnvironmentName":"Production","MachineName":"PC_JEY","ThreadId":3}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.Sqlite.SqliteException (0x80004005): SQLite Error 19: 'NOT NULL constraint failed: PreuvesQualiopi.CommentaireValidation'.
   at Microsoft.Data.Sqlite.SqliteException.ThrowExceptionForRC(Int32 rc, sqlite3 db)
   at Microsoft.Data.Sqlite.SqliteDataReader.NextResult()
   at Microsoft.Data.Sqlite.SqliteCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.Data.Sqlite.SqliteCommand.ExecuteReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.Data.Sqlite.SqliteCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
[2026-02-03 00:51:26.211 +01:00 ERR] HTTP POST /QualiopiUi/ValiderPreuve responded 500 in 95.6400 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ2MFUA0N8S:00000005","ConnectionId":"0HNJ2MFUA0N8S","EnvironmentName":"Production","MachineName":"PC_JEY","ThreadId":3}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.Sqlite.SqliteException (0x80004005): SQLite Error 19: 'NOT NULL constraint failed: PreuvesQualiopi.CommentaireValidation'.
   at Microsoft.Data.Sqlite.SqliteException.ThrowExceptionForRC(Int32 rc, sqlite3 db)
   at Microsoft.Data.Sqlite.SqliteDataReader.NextResult()
   at Microsoft.Data.Sqlite.SqliteCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.Data.Sqlite.SqliteCommand.ExecuteReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.Data.Sqlite.SqliteCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at FormationManager.Services.QualiopiService.ValiderPreuveAsync(Int32 preuveId, String commentaire) in C:\AI\Opagax\Services\QualiopiService.cs:line 127
   at FormationManager.Controllers.QualiopiUiController.ValiderPreuve(Int32 id, String commentaire) in C:\AI\Opagax\Controllers\QualiopiController.cs:line 333
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeFilterPipelineAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
[2026-02-03 00:51:26.231 +01:00 ERR] An unhandled exception has occurred while executing the request. {"EventId":{"Id":1,"Name":"UnhandledException"},"SourceContext":"Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware","RequestId":"0HNJ2MFUA0N8S:00000005","RequestPath":"/QualiopiUi/ValiderPreuve","ConnectionId":"0HNJ2MFUA0N8S","EnvironmentName":"Production","MachineName":"PC_JEY","ThreadId":3}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.Sqlite.SqliteException (0x80004005): SQLite Error 19: 'NOT NULL constraint failed: PreuvesQualiopi.CommentaireValidation'.
   at Microsoft.Data.Sqlite.SqliteException.ThrowExceptionForRC(Int32 rc, sqlite3 db)
   at Microsoft.Data.Sqlite.SqliteDataReader.NextResult()
   at Microsoft.Data.Sqlite.SqliteCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.Data.Sqlite.SqliteCommand.ExecuteReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.Data.Sqlite.SqliteCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at FormationManager.Services.QualiopiService.ValiderPreuveAsync(Int32 preuveId, String commentaire) in C:\AI\Opagax\Services\QualiopiService.cs:line 127
   at FormationManager.Controllers.QualiopiUiController.ValiderPreuve(Int32 id, String commentaire) in C:\AI\Opagax\Controllers\QualiopiController.cs:line 333
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeFilterPipelineAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
[2026-02-03 00:51:26.248 +01:00 ERR] Exception non gérée : An error occurred while saving the entity changes. See the inner exception for details. {"SourceContext":"FormationManager.Infrastructure.Exceptions.GlobalExceptionHandler","RequestId":"0HNJ2MFUA0N8S:00000005","RequestPath":"/QualiopiUi/ValiderPreuve","ConnectionId":"0HNJ2MFUA0N8S","EnvironmentName":"Production","MachineName":"PC_JEY","ThreadId":3}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.Sqlite.SqliteException (0x80004005): SQLite Error 19: 'NOT NULL constraint failed: PreuvesQualiopi.CommentaireValidation'.
   at Microsoft.Data.Sqlite.SqliteException.ThrowExceptionForRC(Int32 rc, sqlite3 db)
   at Microsoft.Data.Sqlite.SqliteDataReader.NextResult()
   at Microsoft.Data.Sqlite.SqliteCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.Data.Sqlite.SqliteCommand.ExecuteReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.Data.Sqlite.SqliteCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at FormationManager.Services.QualiopiService.ValiderPreuveAsync(Int32 preuveId, String commentaire) in C:\AI\Opagax\Services\QualiopiService.cs:line 127
   at FormationManager.Controllers.QualiopiUiController.ValiderPreuve(Int32 id, String commentaire) in C:\AI\Opagax\Controllers\QualiopiController.cs:line 333
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeFilterPipelineAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
[2026-02-03 00:51:31.718 +01:00 INF] HTTP GET /QualiopiUi/Preuves responded 200 in 7.2736 ms {"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HNJ2MFUA0N8S:00000006","ConnectionId":"0HNJ2MFUA0N8S","EnvironmentName":"Production","MachineName":"PC_JEY","ThreadId":18}
